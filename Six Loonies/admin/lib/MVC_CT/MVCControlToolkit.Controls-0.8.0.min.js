/* ****************************************************************************
*
* Copyright (c) Francesco Abbruzzese. All rights reserved.
* francesco@dotnet-programming.com
* http://www.dotnet-programming.com/
* 
* This software is subject to the the license at http://mvccontrolstoolkit.codeplex.com/license  
* and included in the license.txt file of this distribution.
* 
* You must not remove this notice, or any other, from this software.
*
* ***************************************************************************/
function MvcControlsToolkit_Trim(a){return a.replace(/^\s+|\s+$/g,"")}function GlobalEvalScriptInElementId(a){GlobalEvalScriptInElementIdById(a.id)}function GlobalEvalScriptInElementIdById(d){var a=$("#"+d).find("script");var c="";for(var b=0;b<a.length;b++){c+=a[b].text}jQuery.globalEval(c)}function CollectAllScriptsInelement(d){var a=$("#"+d).find("script");var c="";for(var b=0;b<a.length;b++){c+=a[b].text}return c}var ValidationType_StandardClient="StandardClient";var ValidationType_UnobtrusiveClient="UnobtrusiveClient";var ValidationType_Server="Server";function MvcControlsToolkit_Validate(c,b){if(b==ValidationType_StandardClient){if(typeof document.getElementById(c)[MvcControlsToolkit_FieldContext_Tag]==="undefined"){return}document.getElementById(c)[MvcControlsToolkit_FieldContext_Tag].validate("blur")}else{if(b==ValidationType_UnobtrusiveClient){var a="#"+c;$(a).parents("form").validate().element(a)}}}function MvcControlsToolkit_FormIsValid(d,a){if(a==ValidationType_StandardClient){var b=null;$("#"+d).parents("form").each(function(e){b=this[MvcControlsToolkit_FieldContext_formValidationTag]});if(b==null){return true}var c=b.validate("submit");if(c&&c.length){return false}else{return true}}else{if(a==ValidationType_UnobtrusiveClient){return $("#"+d).parents("form").validate().form()}else{return true}}}var MvcControlsToolkit_FieldContext_hasValidationFiredTag="__MVC_HasValidationFired";var MvcControlsToolkit_FieldContext_formValidationTag="__MVC_FormValidation";var MvcControlsToolkit_FieldContext_Tag="__MVC_FieldContext";var MvcControlsToolkit_SpecialFormName="_Template_Data_";function MvcControlsToolkit_FormContext$_isElementInHierarchy(a,b){if(b==null){return false}while(b){if(a===b){return true}b=b.parentNode}return false}function MvcControlsToolkit_FieldContext$validate(a){if(typeof Sys==="undefined"||Sys===null||typeof Sys.Mvc==="undefined"||Sys.Mvc===null||typeof Sys.Mvc.FormContext==="undefined"||Sys.Mvc.FormContext===null){return}for(var b=0;b<this.elements.length;b++){if(!MvcControlsToolkit_FormContext$_isElementInHierarchy(document.body,this.elements[b])){this.clearErrors();return[]}}return this.baseValidate(a)}function MvcControlsToolkit_FieldContext$enableDynamicValidation(){for(var b=0;b<this.elements.length;b++){var a=this.elements[b];a[MvcControlsToolkit_FieldContext_Tag]=this}this.baseEnableDynamicValidation()}if(typeof Sys!=="undefined"&&Sys!==null&&typeof Sys.Mvc!=="undefined"&&Sys.Mvc!==null&&typeof Sys.Mvc.FormContext!=="undefined"&&Sys.Mvc.FormContext!==null){Sys.Mvc.FieldContext.prototype.baseValidate=Sys.Mvc.FieldContext.prototype.validate;Sys.Mvc.FieldContext.prototype.validate=MvcControlsToolkit_FieldContext$validate;Sys.Mvc.FieldContext.prototype.baseEnableDynamicValidation=Sys.Mvc.FieldContext.prototype.enableDynamicValidation;Sys.Mvc.FieldContext.prototype.enableDynamicValidation=MvcControlsToolkit_FieldContext$enableDynamicValidation;Sys.Mvc.FieldContext.prototype._dependsOn=new Array();Sys.Mvc.FieldContext.prototype._dependencyOnBlur=function(a){this.validate("blur")};Sys.Mvc.FieldContext.prototype.takeDynamicValue=function(h){var g=null;if(this.elements.length>0){g=this.elements[0]}if(g==null){return null}var e=g.name;var d=e.lastIndexOf(".");if(d>=0){var c=e.substring(d+1);var a=g.id;a=a.substring(0,a.lastIndexOf(c));h=a+h}var f=document.getElementById(h);if(f==null){return null}var b=false;if(this._dependsOn==null){this._dependsOn=new Array();this._dependsOn[h]=f;b=true}else{if(typeof this._dependsOn[h]==="undefined"){this._dependsOn[h]=f;b=true}}if(b){Sys.UI.DomEvent.addHandler(f,"blur",Function.createDelegate(this,this._dependencyOnBlur))}return f.value};Sys.Mvc.ValidatorRegistry.validators.dynamicrange=function(c){var a=c.ValidationParameters.min;var b=c.ValidationParameters.max;return function(f,e){if(!f||!f.length){return true}var d=Number.parseLocale(f);if(!isNaN(d)&&(a==null||a<=d)&&(b==null||d<=b)){return true}return c.ErrorMessage}};Sys.Mvc.ValidatorRegistry.validators.clientdynamirange=function(d){var c=d.ValidationParameters.min;var e=d.ValidationParameters.max;var a=d.ValidationParameters.mindelay;var b=d.ValidationParameters.maxdelay;return function(l,g){if(!l||!l.length){return true}var f=Number.parseLocale(l);var k=null;var m=null;if(c!=null){var h=g.fieldContext.takeDynamicValue(c);if(h!=null){k=Number.parseLocale(h);if(isNaN(k)){k=null}else{if(a!=null){k=k+a}}}}if(e!=null){var j=g.fieldContext.takeDynamicValue(e);if(j!=null){m=Number.parseLocale(j);if(isNaN(m)){m=null}else{if(b!=null){m=m+b}}}}if(!isNaN(f)&&(k==null||k<=f)&&(m==null||f<=m)){return true}return d.ErrorMessage}};Sys.Mvc.ValidatorRegistry.validators.daterange=function(rule){var sminValue=rule.ValidationParameters.min;var smaxValue=rule.ValidationParameters.max;var minValue=null;var maxValue=null;if(sminValue!=null){sminValue="new "+sminValue.substring(1,sminValue.length-1);minValue=eval(sminValue)}if(smaxValue!=null){smaxValue="new "+smaxValue.substring(1,smaxValue.length-1);maxValue=eval(smaxValue)}return function(value,context){if(!value||!value.length){return true}var convertedValue=Date.parseLocale(value);if(convertedValue!=null&&(minValue==null||minValue<=convertedValue)&&(maxValue==null||convertedValue<=maxValue)){return true}return rule.ErrorMessage}};Sys.Mvc.ValidatorRegistry.validators.clientdynamicdaterange=function(f){var e=f.ValidationParameters.min;var g=f.ValidationParameters.max;var a=f.ValidationParameters.mindelay;var b=f.ValidationParameters.maxdelay;var c=null;var d=null;return function(m,j){if(!m||!m.length){return true}var h=Date.parseLocale(m);if(e!=null){var k=j.fieldContext.takeDynamicValue(e);if(k!=null){c=Date.parseLocale(k);if(a!=null){c=new Date(c.getTime()+a)}}}if(g!=null){var l=j.fieldContext.takeDynamicValue(g);if(l!=null){d=Date.parseLocale(l);if(b!=null){d=new Date(d.getTime()+b)}}}if(h!=null&&(c==null||c<=h)&&(d==null||h<=d)){return true}return f.ErrorMessage}}}if(typeof $!=="undefined"&&$!==null&&typeof $.validator!=="undefined"&&$.validator!==null&&typeof $.validator.unobtrusive!=="undefined"&&$.validator.unobtrusive!==null){(function(a){a.validator.takeDynamicValue=function(e,k){if(e==null){return null}var b=e.name;var f=b.lastIndexOf(".");if(f>=0){var h=b.substring(f+1);var c=e.id;c=c.substring(0,c.lastIndexOf(h));k=c+k}var d=document.getElementById(k);if(d==null){return null}var g=false;var j=jQuery.data(e,"_dependsOn");if(typeof j=="undefined"||j==null){j=new Array();j[k]=d;jQuery.data(e,"_dependsOn",j);g=true}else{if(typeof j[k]==="undefined"){j[k]=d;g=true}}if(g){a(d).blur(function(){a(e).parents("form").first().validate().element(e)})}return d.value};a.validator.unobtrusive.clearAndParse=function(b){var c=a(b).parents("form");if(c.length!=0){c.removeData("validator")}else{a(b).removeData("validator")}a.validator.unobtrusive.parse(b)};a.validator.unobtrusive.parseExt=function(b){a.validator.unobtrusive.parse(b);var e=a(b).first().closest("form");var d=e.data("unobtrusiveValidation");var c=e.validate();a.each(d.options.rules,function(g,f){if(c.settings.rules[g]==undefined){var h={};a.extend(h,f);h.messages=d.options.messages[g];a("[name="+g+"]").rules("add",h)}else{a.each(f,function(l,k){if(c.settings.rules[g][l]==undefined){var j={};j[l]=k;j.messages=d.options.messages[g][l];a("[name="+g+"]").rules("add",j)}})}})}})($);$.validator.addMethod("dynamicrange",function(d,b,f){var c=f[0];if(c==""){c=null}var e=f[1];if(e==""){e=null}if((!d||!d.length)&&this.optional(b)){return true}var a=null;if(typeof jQuery.global!=="undefined"&&typeof jQuery.global.parseFloat==="function"){a=jQuery.global.parseFloat(d)}else{a=parseFloat(d)}if(!isNaN(a)&&(c==null||c<=a)&&(e==null||a<=e)){return true}return false},"value is not in the required range");jQuery.validator.unobtrusive.adapters.add("dynamicrange",["min","max"],function(b){var c=b.params.min,a=b.params.max;b.rules.dynamicrange=[c,a];if(b.message){b.messages.dynamicrange=b.message}});$.validator.addMethod("clientdynamirange",function(m,h,e){var f=e[0];if(f==""){f=null}var a=e[2];if(a==""){a=null}var g=e[1];if(g==""){g=null}var c=e[3];if(c==""){c=null}var l=null;var k=null;if(g!=null){g=parseFloat(g)}if(c!=null){c=parseFloat(c)}if((!m||!m.length)&&this.optional(h)){return true}var b=null;if(typeof jQuery.global!=="undefined"&&typeof jQuery.global.parseFloat==="function"){b=jQuery.global.parseFloat(m)}else{b=parseFloat(m)}if(f!=null){var j=$.validator.takeDynamicValue(h,f);if(j!=null){l=null;if(typeof jQuery.global!=="undefined"&&typeof jQuery.global.parseFloat==="function"){l=jQuery.global.parseFloat(j)}else{l=parseFloat(j)}if(isNaN(l)){l=null}else{if(g!=null){l=l+g}}}}if(a!=null){var d=$.validator.takeDynamicValue(h,a);if(d!=null){k=null;if(typeof jQuery.global!=="undefined"&&typeof jQuery.global.parseFloat==="function"){k=jQuery.global.parseFloat(d)}else{k=parseFloat(d)}if(isNaN(k)){k=null}else{if(c!=null){k=k+c}}}}if(!isNaN(b)&&(l==null||l<=b)&&(k==null||b<=k)){return true}return false},"value is not in the required range");jQuery.validator.unobtrusive.adapters.add("clientdynamirange",["min","mindelay","max","maxdelay"],function(a){var b=a.params.min,c=a.params.mindelay;max=a.params.max,maxdelay=a.params.maxdelay;a.rules.clientdynamirange=[b,c,max,maxdelay];if(a.message){a.messages.clientdynamirange=a.message}});$.validator.addMethod("daterange",function(d,b,f){var c=f[0];if(c==""){c=null}var e=f[1];if(e==""){e=null}if(c!=null){c=new Date(c)}if(e!=null){e=new Date(e)}if((!d||!d.length)&&this.optional(b)){return true}var a=null;if(typeof jQuery.global!=="undefined"&&typeof jQuery.global.parseFloat==="function"){a=new Date(d);a=jQuery.global.parseDate(d)}else{a=new Date(d)}if(!isNaN(a)&&(c==null||c<=a)&&(e==null||a<=e)){return true}return false},"date is not in the required range");jQuery.validator.unobtrusive.adapters.add("daterange",["min","max"],function(b){var c=b.params.min,a=b.params.max;b.rules.daterange=[c,a];if(b.message){b.messages.daterange=b.message}});$.validator.addMethod("clientdynamicdateRange",function(m,h,e){var f=e[0];if(f==""){f=null}var a=e[2];if(a==""){a=null}var g=e[1];if(g==""){g=null}var c=e[3];if(c==""){c=null}var l=null;var k=null;if(g!=null){g=parseInt(g)}if(c!=null){c=parseInt(c)}if((!m||!m.length)&&this.optional(h)){return true}var b=null;if(typeof jQuery.global!=="undefined"&&typeof jQuery.global.parseFloat==="function"){b=jQuery.global.parseDate(m)}else{b=parseDate(m)}if(f!=null){var j=$.validator.takeDynamicValue(h,f);if(j!=null){l=null;if(typeof jQuery.global!=="undefined"&&typeof jQuery.global.parseFloat==="function"){l=jQuery.global.parseDate(j)}else{l=parseDate(j)}if(isNaN(l)){l=null}else{if(g!=null){l=new Date(l.getTime()+g)}}}}if(a!=null){var d=$.validator.takeDynamicValue(h,a);if(d!=null){k=null;if(typeof jQuery.global!=="undefined"&&typeof jQuery.global.parseFloat==="function"){k=jQuery.global.parseDate(d)}else{k=parseDate(d)}if(isNaN(k)){k=null}else{if(c!=null){k=new Date(k.getTime()+c)}}}}if(!isNaN(b)&&(l==null||l<=b)&&(k==null||b<=k)){return true}return false},"date is not in the required range");jQuery.validator.unobtrusive.adapters.add("clientdynamicdateRange",["min","mindelay","max","maxdelay"],function(a){var b=a.params.min,c=a.params.mindelay;max=a.params.max,maxdelay=a.params.maxdelay;a.rules.clientdynamicdateRange=[b,c,max,maxdelay];if(a.message){a.messages.clientdynamicdateRange=a.message}})}var DualSelect_Separator=";;;";var DualSelect_SelectAvial="_AvialSelect";var DualSelect_SelectSelected="_SelSelect";var DualSelect_HiddenSelectedItemsVal="";var DualSelect_TempObjSource,DualSelect_TempObjDestination;function DualSelect_SetObjects(b,a){if(a){DualSelect_TempObjSource=document.getElementById(b+DualSelect_SelectAvial);DualSelect_TempObjDestination=document.getElementById(b+DualSelect_SelectSelected)}else{DualSelect_TempObjSource=document.getElementById(b+DualSelect_SelectSelected);DualSelect_TempObjDestination=document.getElementById(b+DualSelect_SelectAvial)}}function DualSelect_GetIndexForInsert(b,c){if(b.autosort=="false"){return b.length+1}if(b.length==0){return 0}for(var a=0;a<b.length;a++){if(b[a].text>c.text){return a}}return b.length}function DualSelect_MoveElement(c,a){DualSelect_SetObjects(c,a);if(DualSelect_TempObjSource.length==0){return}iLast=0;for(var b=0;b<DualSelect_TempObjSource.length;b++){if(DualSelect_TempObjSource[b].selected){iLast=b;var d=document.createElement("Option");d.text=DualSelect_TempObjSource[b].text;d.value=DualSelect_TempObjSource[b].value;DualSelect_TempObjSource.remove(b);nPos=(DualSelect_TempObjDestination.length+1);DualSelect_TempObjDestination.options.add(d,DualSelect_GetIndexForInsert(DualSelect_TempObjDestination,d));b--}}DualSelect_SaveSelection(c);if(DualSelect_TempObjSource.length>0&&iLast==0){DualSelect_TempObjSource.selectedIndex=0}else{if(DualSelect_TempObjSource.length-1>=iLast){DualSelect_TempObjSource.selectedIndex=iLast}else{if(DualSelect_TempObjSource.length>=1){DualSelect_TempObjSource.selectedIndex=iLast-1}}}DualSelect_ClearSelection(DualSelect_TempObjSource);DualSelect_TempObjSource.focus}function DualSelect_Move_Up(e,b){DualSelect_SetObjects(e,b);if(DualSelect_TempObjSource.length==0){return}if(DualSelect_TempObjSource[0].selected){return}for(var c=1;c<DualSelect_TempObjSource.length;c++){if(DualSelect_TempObjSource[c].selected){var d=DualSelect_TempObjSource[c].value;var f=DualSelect_TempObjSource[c].text;var a=DualSelect_TempObjSource[c].selected;DualSelect_TempObjSource[c].value=DualSelect_TempObjSource[c-1].value;DualSelect_TempObjSource[c].text=DualSelect_TempObjSource[c-1].text;DualSelect_TempObjSource[c].selected=DualSelect_TempObjSource[c-1].selected;DualSelect_TempObjSource[c-1].value=d;DualSelect_TempObjSource[c-1].text=f;DualSelect_TempObjSource[c-1].selected=a;c--}}DualSelect_SaveSelection(e)}function DualSelect_Move_Down(e,b){DualSelect_SetObjects(e,b);if(DualSelect_TempObjSource.length==0){return}if(DualSelect_TempObjSource[DualSelect_TempObjSource.length-1].selected){return}for(var c=DualSelect_TempObjSource.length-2;c>-1;c--){if(DualSelect_TempObjSource[c].selected){var d=DualSelect_TempObjSource[c].value;var f=DualSelect_TempObjSource[c].text;var a=DualSelect_TempObjSource[c].selected;DualSelect_TempObjSource[c].value=DualSelect_TempObjSource[c+1].value;DualSelect_TempObjSource[c].text=DualSelect_TempObjSource[c+1].text;DualSelect_TempObjSource[c].selected=DualSelect_TempObjSource[c+1].selected;DualSelect_TempObjSource[c+1].value=d;DualSelect_TempObjSource[c+1].text=f;DualSelect_TempObjSource[c+1].selected=a;c++}}DualSelect_SaveSelection(e)}function DualSelect_MoveAll(b,a){DualSelect_SetObjects(b,a);while(DualSelect_TempObjSource.length>0){oNode=document.createElement("Option");oNode.text=DualSelect_TempObjSource[0].text;oNode.value=DualSelect_TempObjSource[0].value;DualSelect_TempObjSource.remove(DualSelect_TempObjSource[0]);DualSelect_TempObjDestination.options.add(oNode,DualSelect_GetIndexForInsert(DualSelect_TempObjDestination,oNode))}DualSelect_SaveSelection(b)}function DualSelect_ClearSelection(b){for(var a=0;a<b.length;a++){b[a].selected=false}}function DualSelect_SaveSelection(d){var b=document.getElementById(d+DualSelect_SelectSelected);var c="";var e="";for(var a=0;a<b.length;a++){c+=b[a].value+DualSelect_Separator}document.getElementsByName(d+DualSelect_HiddenSelectedItemsVal)[0].value=c}var defaultYear=1970+0;var defaultMonth=0+0;var defaultDay=1+0;var defaultHour=0+0;var defaultMinute=0+0;var defaultSecond=0+0;function DateInput_Initialize(a){if(document.getElementById(a+"_Year")!=null){document.getElementById(a+"_Year").onkeypress=DateInputYearKeyVerify;document.getElementById(a+"_Year").onpaste=DateInputYearHandlePaste;document.getElementById(a+"_Year").ondrop=DateInputYearHandlePaste;document.getElementById(a+"_Year").onchange=DateInputChanged}if(document.getElementById(a+"_Month")!=null){document.getElementById(a+"_Month").onchange=DateInputChanged}if(document.getElementById(a+"_Day")!=null){document.getElementById(a+"_Day").onchange=DateInputChanged}if(document.getElementById(a+"_Hours")!=null){document.getElementById(a+"_Hours").onchange=DateInputChanged}if(document.getElementById(a+"_Minutes")!=null){document.getElementById(a+"_Minutes").onchange=DateInputChanged}if(document.getElementById(a+"_Seconds")!=null){document.getElementById(a+"_Seconds").onchange=DateInputChanged}}function DateInputGetNumDays(b,a){b=b+1;if(a%4==0){return(b==9||b==4||b==6||b==11)?30:(b==2)?29:31}else{return(b==9||b==4||b==6||b==11)?30:(b==2)?28:31}}function DateTimeAdjustYears(d,c,a){if(d==null){return}var b=0;if(c==d.options[0].value&&a==d.options[d.options.length-1].value){return}d.options.length=0;for(i=c;i<=a;i++){if(i<10){d.options[b]=new Option("   "+i,i)}else{if(i<100){d.options[b]=new Option("  "+i,i)}else{if(i<1000){d.options[b]=new Option(" "+i,i)}else{d.options[b]=new Option(""+i,i)}}}b++}}function DateTimeAdjustMonthes(d,c,a){if(d==null){return}var b=0;if(c==d.options[0].value&&a==d.options[d.options.length-1].value){return}d.options.length=0;for(i=c;i<=a;i++){d.options[b]=new Option(DateTimeMonthes[i],i+1);b++}}function DateTimeAdjustDays(d,c,a){if(d==null){return}var b=0;if(c==d.options[0].value&&a==d.options[d.options.length-1].value){return}d.options.length=0;for(i=c;i<=a;i++){if(i<10){d.options[b]=new Option(" "+i,i)}else{d.options[b]=new Option(""+i,i)}b++}}function DateTimeAdjustTimeElement(d,c,a){if(d==null){return}var b=0;if(c==d.options[0].value&&a==d.options[d.options.length-1].value){return}d.options.length=0;for(i=c;i<=a;i++){if(i<10){d.options[b]=new Option("0"+i,i)}else{d.options[b]=new Option(""+i,i)}b++}}function DateInputYearHandlePaste(a){a=(a)?(a):((window.event)?(window.event):null);if(a==null){return true}var b=(a.target)?(a.target):((event.srcElement)?(event.srcElement):null);if(b==null){return true}var c;if(a.type=="paste"){c=window.clipboardData.getData("Text")}else{if(a.type=="drop"){c=a.dataTransfer.getData("Text")}else{return true}}for(i=0;i<c.length;i++){keyCode=c.charCodeAt(i);if(keyCode==13||keyCode==8){continue}if((keyCode>=48)&&(keyCode<=57)){continue}else{return false}}b.value=c;return false}function DateInputYearKeyVerify(a){a=(a)?(a):((window.event)?(window.event):null);if(a==null){return true}var b=(a.target)?(a.target):((event.srcElement)?(event.srcElement):null);if(b==null){return true}var c=((a.charCode||a.initEvent)?a.charCode:((a.which)?a.which:a.keyCode));if(c==0||c==13||c==8){return true}if((c>=48)&&(c<=57)){return true}return false;var d=b.value}function DateInputChanged(evt,cid,update){var clientID;if(cid==null){evt=(evt)?(evt):((window.event)?(window.event):null);if(evt==null){return false}var sorg=(evt.target)?(evt.target):((event.srcElement)?(event.srcElement):null);if(sorg==null){return false}clientID=sorg.id.substring(0,sorg.id.lastIndexOf("_"))}else{clientID=cid}if(eval(clientID+"Recursive")==true){return}eval(clientID+"Recursive = true;");var Nanno;var Nmese;var Ngiorno;var NHours;var NMinutes;var NSeconds;var CurrDate=eval(clientID+"_Curr");var CurrDay=CurrDate.getDate();var CurrMonth=CurrDate.getMonth();var CurrYear=CurrDate.getFullYear();var CurrHours=CurrDate.getHours();var CurrMinutes=CurrDate.getMinutes();var CurrSeconds=CurrDate.getSeconds();var currMin=eval(clientID+"_MinDate");var currMax=eval(clientID+"_MaxDate");var dynamicMin=null;if(eval("(typeof "+clientID+"_ClientDynamicMin !== 'undefined') && ("+clientID+"_ClientDynamicMin != null)")==true){dynamicMin=eval(clientID+"_ClientDynamicMin()")}var dynamicMax=null;if(eval("(typeof "+clientID+"_ClientDynamicMax !== 'undefined') && ("+clientID+"_ClientDynamicMax != null)")==true){dynamicMax=eval(clientID+"_ClientDynamicMax()")}if(dynamicMin!=null&&(currMin==null||dynamicMin>currMin)){if(dynamicMin>currMax){currMin=currMax}else{currMin=dynamicMin}}if(dynamicMax!=null&&(currMax==null||dynamicMax<currMax)){if(dynamicMax<currMin){currMax=currMin}else{currMax=dynamicMax}}if(document.getElementById(clientID+"_Year")!=null){Nanno=document.getElementById(clientID+"_Year").value}else{Nanno=CurrYear}if(document.getElementById(clientID+"_Month")!=null){Nmese=document.getElementById(clientID+"_Month").value}else{Nmese=CurrMonth}if(document.getElementById(clientID+"_Day")!=null){Ngiorno=document.getElementById(clientID+"_Day").value}else{Ngiorno=CurrDay}if(document.getElementById(clientID+"_Hours")!=null){NHours=document.getElementById(clientID+"_Hours").value}else{NHours=CurrHours}if(document.getElementById(clientID+"_Minutes")!=null){NMinutes=document.getElementById(clientID+"_Minutes").value}else{NMinutes=CurrMinutes}if(document.getElementById(clientID+"_Seconds")!=null){NSeconds=document.getElementById(clientID+"_Seconds").value}else{NSeconds=CurrSeconds}var TempNewDate=new Date(Nanno,Nmese-1,Ngiorno,NHours,NMinutes,NSeconds);if(currMax!=null&&currMax<TempNewDate){TempNewDate=currMax}if(currMin!=null&&currMin>TempNewDate){TempNewDate=currMin}Nanno=TempNewDate.getFullYear()+"";Nmese=(TempNewDate.getMonth()+1)+"";Ngiorno=TempNewDate.getDate()+"";NHours=TempNewDate.getHours()+"";NMinutes=TempNewDate.getMinutes()+"";NSeconds=TempNewDate.getSeconds()+"";var NewYear;var NewMonth;var NewDay;var NewHours;var NewMinutes;var NewSeconds;var MaxYear;var MinYear;var MaxMonth;var MinMonth;var MinDay;var MaxDay;var MinHours;var MaxHours;var MinMinutes;var MaxMinutes;var MinSeconds;var MaxSeconds;eval(clientID+"_Valid = true");NewYear=parseInt(Nanno);if(!isNaN(NewYear)){if(currMax==null){MaxYear=null}else{MaxYear=currMax.getFullYear()}if(currMin==null){MinYear=null}else{MinYear=currMin.getFullYear()}if(MaxYear!=null&&MaxYear<NewYear){NewYear=MaxYear}if(MinYear!=null&&MinYear>NewYear){NewYear=MinYear}if(document.getElementById(clientID+"_Year")!=null&&!eval(clientID+"_DateHidden")&&eval(clientID+"_YearCombo")){DateTimeAdjustYears(document.getElementById(clientID+"_Year"),MinYear,MaxYear)}if((MaxYear==null||MaxYear>=NewYear)&&(MinYear==null||MinYear<=NewYear)){MaxMonth=11;MinMonth=0;if(MaxYear==NewYear){MaxMonth=currMax.getMonth()}if(MinYear==NewYear){MinMonth=currMin.getMonth()}NewMonth=parseInt(Nmese);if(!isNaN(NewMonth)){NewMonth=NewMonth-1;if(MinMonth>NewMonth){NewMonth=MinMonth}if(MaxMonth<NewMonth){NewMonth=MaxMonth}if(CurrYear==MinYear||CurrYear==MaxYear||NewYear==MinYear||NewYear==MaxYear){if(document.getElementById(clientID+"_Month")!=null&&!eval(clientID+"_DateHidden")){DateTimeAdjustMonthes(document.getElementById(clientID+"_Month"),MinMonth,MaxMonth)}}MinDay=1;MaxDay=DateInputGetNumDays(NewMonth,NewYear);if(MaxYear==NewYear&&MaxMonth==NewMonth){MaxDay=currMax.getDate()}if(MinYear==NewYear&&MinMonth==NewMonth){MinDay=currMin.getDate()}NewDay=parseInt(Ngiorno);if(!isNaN(NewDay)){if(MinDay>NewDay){NewDay=MinDay}if(MaxDay<NewDay){NewDay=MaxDay}if(document.getElementById(clientID+"_Day")!=null&&!eval(clientID+"_DateHidden")){DateTimeAdjustDays(document.getElementById(clientID+"_Day"),MinDay,MaxDay)}MinHours=0;MaxHours=23;if(MaxYear==NewYear&&MaxMonth==NewMonth&&NewDay==MaxDay){MaxHours=currMax.getHours()}if(MinYear==NewYear&&MinMonth==NewMonth&&NewDay==MinDay){MinHours=currMin.getHours()}NewHours=parseInt(NHours);if(!isNaN(NewHours)){if(MaxHours<NewHours){NewHours=MaxHours}if(NewHours<MinHours){NewHours=MinHours}if(document.getElementById(clientID+"_Hours")!=null){DateTimeAdjustTimeElement(document.getElementById(clientID+"_Hours"),MinHours,MaxHours)}MinMinutes=0;MaxMinutes=59;if(MaxYear==NewYear&&MaxMonth==NewMonth&&NewDay==MaxDay&&MaxHours==NewHours){MaxMinutes=currMax.getMinutes()}if(MinYear==NewYear&&MinMonth==NewMonth&&NewDay==MinDay&&MinHours==NewHours){MinMinutes=currMin.getMinutes()}NewMinutes=parseInt(NMinutes);if(!isNaN(NewMinutes)){if(MaxMinutes<NewMinutes){NewMinutes=MaxMinutes}if(MinMinutes>NewMinutes){NewMinutes=MinMinutes}if(document.getElementById(clientID+"_Minutes")!=null){DateTimeAdjustTimeElement(document.getElementById(clientID+"_Minutes"),MinMinutes,MaxMinutes)}MinSeconds=0;MaxSeconds=59;if(MaxYear==NewYear&&MaxMonth==NewMonth&&NewDay==MaxDay&&MaxHours==NewHours&&MaxMinutes==NewMinutes){MaxSeconds=currMax.getSeconds()}if(MinYear==NewYear&&MinMonth==NewMonth&&NewDay==MinDay&&MinHours==NewHours&&MinMinutes==NewMinutes){MinSeconds=currMin.getSeconds()}NewSeconds=parseInt(NSeconds);if(!isNaN(NewSeconds)){if(MaxSeconds<NewSeconds){NewSeconds=MaxSeconds}if(NewSeconds<MinSeconds){NewSeconds=MinSeconds}if(document.getElementById(clientID+"_Seconds")!=null){DateTimeAdjustTimeElement(document.getElementById(clientID+"_Seconds"),MinSeconds,MaxSeconds)}}else{eval(clientID+"_Valid = false")}}else{eval(clientID+"_Valid = false")}}else{eval(clientID+"_Valid = false")}}else{eval(clientID+"_Valid = false")}}else{eval(clientID+"_Valid = false")}}}else{eval(clientID+"_Valid = false")}var AChange=false;if(eval(clientID+"_Valid")){if(update==true||(cid==null&&(CurrYear!=NewYear||CurrMonth!=NewMonth||CurrDay!=NewDay||CurrHours!=NewHours||CurrMinutes!=NewMinutes||CurrSeconds!=NewSeconds))){AChange=true}CurrYear=NewYear;CurrMonth=NewMonth;CurrDay=NewDay;CurrHours=NewHours;CurrMinutes=NewMinutes;CurrSeconds=NewSeconds}if(!AChange){eval(clientID+"Recursive = false;");return true}eval(clientID+"_Curr = new Date(CurrYear, CurrMonth, CurrDay, CurrHours, CurrMinutes, CurrSeconds)");if(document.getElementById(clientID+"_Year")!=null){document.getElementById(clientID+"_Year").value=CurrYear}if(document.getElementById(clientID+"_Month")!=null){document.getElementById(clientID+"_Month").value=CurrMonth+1}if(document.getElementById(clientID+"_Day")!=null){document.getElementById(clientID+"_Day").value=CurrDay}if(document.getElementById(clientID+"_Hours")!=null){document.getElementById(clientID+"_Hours").value=CurrHours}if(document.getElementById(clientID+"_Minutes")!=null){document.getElementById(clientID+"_Minutes").value=CurrMinutes}if(document.getElementById(clientID+"_Seconds")!=null){document.getElementById(clientID+"_Seconds").value=CurrSeconds}var currDate=eval(clientID+"_Curr");RefreshDependencies(clientID);eval(clientID+"_ClientDateChanged("+currDate.getTime()+")");eval(clientID+"Recursive = false;");return true}function SetDateInput(id,value,cType){if(eval("typeof "+id+"_Curr === 'undefined'")==true){return}var currDate=eval(id+"_Curr");if(currDate==null){return}var currDateInMilliseconds=currDate.getTime();if(cType==1&&value>=currDateInMilliseconds){return}if(cType==2&&value<=currDateInMilliseconds){return}var DateInFormat=new Date(value);if(document.getElementById(id+"_Hours")!=null){if(document.getElementById(id+"_Year"!=null)){document.getElementById(id+"_Year").value=DateInFormat.getFullYear();DateInputChanged(null,id,false)}if(document.getElementById(id+"_Month")!=null){document.getElementById(id+"_Month").value=(DateInFormat.getMonth()+1);DateInputChanged(null,id,false)}if(document.getElementById(id+"_Day")!=null){document.getElementById(id+"_Day").value=DateInFormat.getDate();DateInputChanged(null,id,false)}if(document.getElementById(id+"_Hours")!=null){document.getElementById(id+"_Hours").value=DateInFormat.getHours();DateInputChanged(null,id,false)}if(document.getElementById(id+"_Minutes")!=null){document.getElementById(id+"_Minutes").value=DateInFormat.getMinutes();DateInputChanged(null,id,false)}if(document.getElementById(id+"_Seconds")!=null){document.getElementById(id+"_Seconds").value=DateInFormat.getSeconds();DateInputChanged(null,id,true)}else{if(document.getElementById(id+"_Year"!=null)){document.getElementById(id+"_Year").value=DateInFormat.getFullYear();DateInputChanged(null,id,false)}if(document.getElementById(id+"_Month")!=null){document.getElementById(id+"_Month").value=(DateInFormat.getMonth()+1);DateInputChanged(null,id,false)}if(document.getElementById(id+"_Day")!=null){document.getElementById(id+"_Day").value=DateInFormat.getDate();DateInputChanged(null,id,true)}}}}function GetDateInput(id){return eval(id+"_Curr")}function AddToUpdateList(id,toAdd){if(id==null||toAdd==null){return}var currIndex=eval(id+"_UpdateListIndex");eval(id+"_UpdateList["+currIndex+"] = '"+toAdd+"';");currIndex++;eval(id+"_UpdateListIndex = "+currIndex+";")}function RefreshDependencies(id){if(eval("typeof "+id+"_UpdateListIndex === 'undefined'")==true){return}var length=eval(id+"_UpdateListIndex");if(length==null){return}for(var i=0;i<length;i++){DateInputChanged(null,eval(id+"_UpdateList["+i+"]"),true)}}var DataButtonCancel="DataButtonCancel";var DataButtonDelete="DataButtonDelete";var DataButtonUndelete="DataButtonUndelete";var DataButtonEdit="DataButtonEdit";var DataButtonInsert="DataButtonInsert";var DataButtonResetRow="DataButtonResetRow";var DisplayPostfix="_Display";var EditPostfix="_Edit";var OldEditPostfix="_OldEdit";var UndeletePostfix="_Undelete";var ChangedExternallyPostfix="_ChangedExternally";var SavePostFix="_Save";var SavePostFixCurr="_SaveCurr";var DatagridFielsdPostfix="_Datagrid_Fields";var SavePostFixD="_SaveD";var SavePostFixU="_SaveU";var SavePostFixC="_SaveC";var DeletedPostFix="_Deleted";var ContainerPostFix="_Container";var VarPostfix="_Var";var AllNormalPostfix="_AllNormal";var ChandedPostfix="_Changed";var TemplateVarsPostfix="_templateVars";var TemplatePreparePostfix="_templatePrepare";var PlaceHolderPostfix="_placeHolder";var ChangedHiddenPostfix="_changedHidden";var TemplateSymbolPostfix="_templateSymbol";var LastIndexPostfix="_lastIndex";var DataGrid_ValidationTypePostfix="_validationType";var MinLastIndexPostfix="_minLastIndex";var LastVisibleIndexPostfix="_lastVisibleIndex";var TemplateEditHtmlPostfix="_editHtml";var TemplateDisplayHtmlPostfix="_displayHtml";var TemplateAllJavascriptPostfix="_allJavascript";function DataGrid_Field(b,c,a){this.Original=b;this.Current=c;this.ValidationType=a}DataGrid_Field.prototype={Original:null,Current:null,ValidationType:null,Reset:function(){if(this.Original==null){return}if(this.Current==null){return}if(this.Original.nodeName.toLowerCase()=="input"){if(this.Original.getAttribute("type").toLowerCase()=="checkbox"||this.Original.getAttribute("type").toLowerCase()=="radiobutton"){this.Current.checked=this.Original.checked}else{this.Current.value=this.Original.value}}else{if(this.Original.nodeName.toLowerCase()=="textarea"){this.Current.value=this.Original.value}}MvcControlsToolkit_Validate(this.Current.id,this.ValidationType)}};function DataGrid_EditRowFields(a){this.Names=new Array();this.Dictionary=new Array();this.ValidationType=a}DataGrid_EditRowFields.prototype={Names:null,Dictionary:null,ValidationType:null,AddOriginal:function(b,a){if(typeof this.Dictionary[b]==="undefined"){this.Names.push(b);this.Dictionary[b]=new DataGrid_Field(a,null,this.ValidationType)}else{this.Dictionary[b].Original=a}},AddCurrent:function(b,a){if(typeof this.Dictionary[b]==="undefined"){this.Names.push(b);this.Dictionary[b]=new DataGrid_Field(null,a,this.ValidationType)}else{this.Dictionary[b].Current=a}},Reset:function(){var b=null;for(var a=0;a<this.Names.length;a++){b=this.Names[a];if(typeof this.Dictionary[b]!=="undefined"){this.Dictionary[b].Reset()}}}};function DataGrid_ResetRow(itemRoot){var fields=null;var temp=null;var validationType=null;var root=itemRoot.substring(0,itemRoot.lastIndexOf("___"));root=root.substring(0,root.lastIndexOf("___"));validationType=eval(root+DataGrid_ValidationTypePostfix);fields=eval(itemRoot+DatagridFielsdPostfix);if(fields==null){fields=new DataGrid_EditRowFields(validationType);eval(itemRoot+DatagridFielsdPostfix+" = fields;");temp=eval(itemRoot+SavePostFix);temp.find("input").each(function(i){fields.AddOriginal(this.id,this)});temp.find("textarea").each(function(i){fields.AddOriginal(this.id,this)});temp=eval(itemRoot+SavePostFixCurr);temp.find("input").each(function(i){fields.AddCurrent(this.id,this)});temp.find("textarea").each(function(i){fields.AddCurrent(this.id,this)});eval(itemRoot+SavePostFix+" = null;")}fields.Reset()}function DataGrid_Remove_Edit_Item(itemRoot){var temp=null;temp=$("#"+itemRoot+EditPostfix+ContainerPostFix).detach();if(temp.length!=0){eval(itemRoot+SavePostFixCurr+" = temp;")}}function DataGrid_Display_Edit_Item(itemRoot){var temp=null;temp=eval(itemRoot+SavePostFixCurr);$("#"+itemRoot+DisplayPostfix+ContainerPostFix).before(temp);DataGrid_ResetRow(itemRoot)}function DataGrid_ItemRoot_AtIndex(c,a){var b=c.substring(c.lastIndexOf("___"));var d=c.substring(0,c.lastIndexOf("___"));d=d.substring(0,d.lastIndexOf("_")+1);return d+a+b}function DataGrid_ItemRoot_Index(a){a=a.substring(0,a.lastIndexOf("___"));a=a.substring(a.lastIndexOf("_")+1);return parseInt(a)}function DataGrid_ChecKInsertNewItem(itemRoot){var root=itemRoot.substring(0,itemRoot.lastIndexOf("___"));root=root.substring(0,root.lastIndexOf("___"));if(eval("typeof "+root+LastIndexPostfix+" === 'undefined'")){return}var index=DataGrid_ItemRoot_Index(itemRoot);var visibleIndex=eval(root+LastVisibleIndexPostfix);if(index!=visibleIndex){return}var lastIndex=eval(root+LastIndexPostfix);if(lastIndex==index){index++;var indexStr=index+"";var templateSymbol=eval(root+TemplateSymbolPostfix);var displayTemplate=eval(root+TemplateDisplayHtmlPostfix).replace(templateSymbol,indexStr);var editTemplate=eval(root+TemplateEditHtmlPostfix).replace(templateSymbol,indexStr);var changed=$("<div>").append($("#"+eval(root+ChangedHiddenPostfix)).clone()).remove().html().replace(templateSymbol,indexStr);var placeHolderName=eval(root+PlaceHolderPostfix);var placeHolder=$("<div>").append($("#"+placeHolderName).clone()).remove().html().replace(templateSymbol,indexStr);$("#"+itemRoot+EditPostfix+ContainerPostFix).after(editTemplate);$("#"+itemRoot+EditPostfix+ContainerPostFix).after(displayTemplate);jQuery.globalEval(eval(root+TemplateAllJavascriptPostfix).replace(templateSymbol,indexStr));var hiddenElementsFather=$("#"+placeHolderName).parent();hiddenElementsFather.append(placeHolder);hiddenElementsFather.append(changed);var newItemName=DataGrid_ItemRoot_AtIndex(itemRoot,index)+EditPostfix+ContainerPostFix;if(typeof $!=="undefined"&&$!==null&&typeof $.validator!=="undefined"&&$.validator!==null&&typeof $.validator.unobtrusive!=="undefined"&&$.validator.unobtrusive!==null){jQuery.validator.unobtrusive.parseExt("#"+newItemName)}var initVars=eval(root+TemplateVarsPostfix).replace(templateSymbol,indexStr);jQuery.globalEval(initVars);var initCall=eval(root+TemplatePreparePostfix).replace(templateSymbol,indexStr);jQuery.globalEval(initCall);visibleIndex++;lastIndex++;eval(root+LastVisibleIndexPostfix+" = visibleIndex;");eval(root+LastIndexPostfix+" = lastIndex;")}else{index++;var nextItem=DataGrid_ItemRoot_AtIndex(itemRoot,index);var temp=eval(nextItem+SavePostFixD);$("#"+nextItem+DisplayPostfix+ContainerPostFix).replaceWith(temp.clone(true));eval(root+LastVisibleIndexPostfix+" = index;")}}function DataGrid_ChecKDisappearItem(itemRoot){var root=itemRoot.substring(0,itemRoot.lastIndexOf("___"));root=root.substring(0,root.lastIndexOf("___"));if(eval("typeof  "+root+LastIndexPostfix+" === 'undefined'")){return}var index=DataGrid_ItemRoot_Index(itemRoot);var visibleIndex=eval(root+LastVisibleIndexPostfix);var minIndex=eval(root+MinLastIndexPostfix);if(index<minIndex){return}if(index!=visibleIndex){if(index==visibleIndex-1){index++;itemRoot=DataGrid_ItemRoot_AtIndex(itemRoot,index);DataGrid_ChecKDisappearItem(itemRoot);return}else{return}}if(index<=minIndex){return}var display=$("#"+itemRoot+DisplayPostfix+ContainerPostFix);if(display.length==0){return}var prevItem=DataGrid_ItemRoot_AtIndex(itemRoot,index-1);if($("#"+prevItem+DisplayPostfix+ContainerPostFix).length==0){return}display.css("display","none");visibleIndex--;eval(root+LastVisibleIndexPostfix+" = visibleIndex");index--;var prevtItem=DataGrid_ItemRoot_AtIndex(itemRoot,index);DataGrid_ChecKDisappearItem(prevItem,root)}function DataButton_Click(itemRoot,itemChanged,dataButtonType){if(dataButtonType==DataButtonDelete){var undel=eval(itemRoot+SavePostFixU);if(undel!=null){$("#"+itemRoot+DisplayPostfix+ContainerPostFix).before(undel.clone(true));$("#"+itemRoot+DisplayPostfix+ContainerPostFix).remove()}else{$("#"+itemRoot+DisplayPostfix+ContainerPostFix).css("display","none")}DataGrid_Remove_Edit_Item(itemRoot);$("#"+itemChanged).val("True");eval(itemRoot+DeletedPostFix+" = true;")}else{if(dataButtonType==DataButtonEdit||dataButtonType==DataButtonInsert){DataGrid_Display_Edit_Item(itemRoot);$("#"+itemRoot+DisplayPostfix+ContainerPostFix).remove();$("#"+itemChanged).val("True");DataGrid_ChecKInsertNewItem(itemRoot)}else{if(dataButtonType==DataButtonCancel){var temp=eval(itemRoot+SavePostFixD);$("#"+itemRoot+EditPostfix+ContainerPostFix).before(temp.clone(true));DataGrid_Remove_Edit_Item(itemRoot);$("#"+itemChanged).val("False");DataGrid_ChecKDisappearItem(itemRoot)}else{if(dataButtonType==DataButtonResetRow){var temp=eval(itemRoot+SavePostFixD);$("#"+itemRoot+EditPostfix+ContainerPostFix).before(temp.clone(true));DataGrid_Remove_Edit_Item(itemRoot);DataGrid_Display_Edit_Item(itemRoot);$("#"+itemRoot+DisplayPostfix+ContainerPostFix).remove()}else{if(dataButtonType==DataButtonUndelete){var undel=eval(itemRoot+SavePostFixU);var temp=eval(itemRoot+SavePostFixD);if(undel!=null){$("#"+itemRoot+UndeletePostfix+ContainerPostFix).before(temp.clone(true));$("#"+itemRoot+UndeletePostfix+ContainerPostFix).remove()}else{$("#"+itemRoot+DisplayPostfix+ContainerPostFix).replaceWith(temp.clone(true))}eval(itemRoot+DeletedPostFix+" = false;");$("#"+itemChanged).val("False")}}}}}}function DataGrid_Prepare_Template(itemRoot,itemChanged,deleted,root){var allJavascript=CollectAllScriptsInelement(itemRoot+EditPostfix+ContainerPostFix)+CollectAllScriptsInelement(itemRoot+DisplayPostfix+ContainerPostFix);eval(root+TemplateAllJavascriptPostfix+" = allJavascript;");$("#"+itemRoot+EditPostfix+ContainerPostFix).find("script").remove();$("#"+itemRoot+DisplayPostfix+ContainerPostFix).find("script").remove();var temp=$("<div>").append($("#"+itemRoot+EditPostfix+ContainerPostFix).clone()).remove().html();eval(root+TemplateEditHtmlPostfix+" = temp;");temp=$("<div>").append($("#"+itemRoot+DisplayPostfix+ContainerPostFix).clone()).remove().html();eval(root+TemplateDisplayHtmlPostfix+" = temp;");$("#"+itemRoot+EditPostfix+ContainerPostFix).remove();$("#"+itemRoot+DisplayPostfix+ContainerPostFix).remove()}function DataGrid_Prepare_Item(itemRoot,itemChanged,deleted,root){var temp=eval(root+AllNormalPostfix);if(temp==null){temp=new Array()}temp.push(itemRoot);eval(root+AllNormalPostfix+" = temp");temp=$("#"+itemRoot+OldEditPostfix+ContainerPostFix).clone(true);$("#"+itemRoot+OldEditPostfix+ContainerPostFix).remove();if(temp.length==0){temp=$("#"+itemRoot+EditPostfix+ContainerPostFix).clone(true)}eval(itemRoot+SavePostFix+" = temp;");temp=$("#"+itemRoot+DisplayPostfix+ContainerPostFix).clone(true);eval(itemRoot+SavePostFixD+" = temp;");temp=$("#"+itemRoot+ChangedExternallyPostfix+ContainerPostFix).clone(true);if(temp!=null&&temp.size()==0){temp=null}eval(itemRoot+SavePostFixC+" = temp;");$("#"+itemRoot+ChangedExternallyPostfix+ContainerPostFix).remove();temp=$("#"+itemRoot+UndeletePostfix+ContainerPostFix).clone(true);if(temp!=null&&temp.size()==0){temp=null}eval(itemRoot+SavePostFixU+" = temp;");if(deleted){DataGrid_Remove_Edit_Item(itemRoot);if(temp==null){$("#"+itemRoot+DisplayPostfix+ContainerPostFix).css("display","none")}else{$("#"+itemRoot+DisplayPostfix+ContainerPostFix).remove()}eval(itemRoot+DeletedPostFix+" = true;")}else{$("#"+itemRoot+UndeletePostfix+ContainerPostFix).remove();if(eval(itemChanged+VarPostfix)){DataGrid_Remove_Edit_Item(itemRoot)}else{$("#"+itemRoot+DisplayPostfix+ContainerPostFix).remove()}eval(itemRoot+DeletedPostFix+" = false;")}}var SortableList_PermutationUpdateRootPrefix="_PermutationUpdateRoot";var SortableList_CanSortPrefix="_CanSort";var SortableList_ElementsNumberPrefix="_ElementsNumber";var SortableList_TemplateSymbolPrefix="_TemplateSymbol";var SortableList_TemplateSriptPrefix="_TemplateSript";var SortableList_TemplateHtmlPrefix="_TemplateHtml";var SortableList_PermutationPrefix="_Permutation";var SortableList_PermutationNamePrefix=".Permutation";var SortableList_UpdateModelPrefix="___";var SortableList_UpdateModelNamePrefix=".$$";var SortableList_UpdateModelFieldsPrefix="_f_ields";var SortableList_UpdateModelFieldsNamePrefix=".f$ields";var SortableList_ItemsContainerPrefix="_ItemsContainer";var SortableList_OriginalElementsNumber="_OriginalElementsNumber";var SortableList_TemplateHiddenPrefix="_TemplateHidden";var SortableList_TemplateHiddenHtmlPrefix="_TemplateHiddenHtml";var SortableList_NamePrefixPrefix="_NamePrefix";function MvcControlsToolkit_SortableList_PrepareTemplate(root,templateId){var allJavascript=CollectAllScriptsInelement(templateId);eval(root+SortableList_TemplateSriptPrefix+" = allJavascript;");$("#"+templateId).find("script").remove();var temp=$("<div>").append($("#"+templateId).clone()).remove().html();eval(root+SortableList_TemplateHtmlPrefix+" = temp;");var hidden=eval(root+SortableList_TemplateHiddenPrefix);temp=$("<div>").append($("#"+hidden).clone()).remove().html();eval(root+SortableList_TemplateHiddenHtmlPrefix+" = temp;");$("#"+templateId).remove();var canSort=eval(root+SortableList_CanSortPrefix);if(canSort){var elementNumber=eval(root+SortableList_ElementsNumberPrefix);var updateModel=document.getElementById(root+SortableList_UpdateModelPrefix+elementNumber);updateModel.setAttribute("id",updateModel.id+"_");var updateModelFields=document.getElementById(root+SortableList_UpdateModelPrefix+elementNumber+SortableList_UpdateModelFieldsPrefix);updateModelFields.setAttribute("id",updateModelFields.id+"_")}}function MvcControlsToolkit_SortableList_AddNew(root){if(eval("typeof  "+root+SortableList_ElementsNumberPrefix+" === 'undefined'")){return}var elementNumber=eval(root+SortableList_ElementsNumberPrefix);var originalElementNumber=eval(root+SortableList_OriginalElementsNumber);var templateSymbol=eval(root+SortableList_TemplateSymbolPrefix);var allJavascript=eval(root+SortableList_TemplateSriptPrefix).replace(templateSymbol,elementNumber+"");var allHtml=eval(root+SortableList_TemplateHtmlPrefix).replace(templateSymbol,elementNumber+"");var hiddenElementFather=$("#"+eval(root+SortableList_TemplateHiddenPrefix)).parent();var hiddenElement=eval(root+SortableList_TemplateHiddenHtmlPrefix).replace(templateSymbol,elementNumber+"");var canSort=eval(root+SortableList_CanSortPrefix);var namePrefix=eval(root+SortableList_NamePrefixPrefix);elementNumber++;eval(root+SortableList_ElementsNumberPrefix+" = elementNumber;");if(canSort){var permutation=document.getElementById(root+SortableList_PermutationPrefix);permutation.setAttribute("name",namePrefix+SortableList_UpdateModelNamePrefix+elementNumber+".$"+SortableList_PermutationNamePrefix);var updateModel=document.getElementById(root+SortableList_UpdateModelPrefix+originalElementNumber+"_");updateModel.setAttribute("name",namePrefix+SortableList_UpdateModelNamePrefix+elementNumber);var updateModelFields=document.getElementById(root+SortableList_UpdateModelPrefix+originalElementNumber+SortableList_UpdateModelFieldsPrefix+"_");updateModelFields.setAttribute("name",namePrefix+SortableList_UpdateModelNamePrefix+elementNumber+SortableList_UpdateModelFieldsNamePrefix)}hiddenElementFather.append(hiddenElement);$("#"+root+SortableList_ItemsContainerPrefix).append(allHtml);if(typeof $!=="undefined"&&$!==null&&typeof $.validator!=="undefined"&&$.validator!==null&&typeof $.validator.unobtrusive!=="undefined"&&$.validator.unobtrusive!==null){$.validator.unobtrusive.parseExt("#"+root+SortableList_ItemsContainerPrefix+" > :last-child")}jQuery.globalEval(allJavascript);if(canSort){Update_Permutations_Root(root);$("#"+root+SortableList_ItemsContainerPrefix).sortable("refresh")}}function Update_Permutations(b){var a=b.lastIndexOf("___");if(a<0){return}var c=b.substring(0,a);a=c.lastIndexOf("___");c=c.substring(0,a);if(a<0){return}return Update_Permutations_Root(c)}function Update_Permutations_Root(a){var k=document.getElementById(a+"_Permutation");if(k==null){return}var j=document.getElementById(a+"_ItemsContainer");if(j==null){return}var h="";for(i=0;i<j.childNodes.length;i++){var c=j.childNodes[i].getAttribute("id");var e=c.lastIndexOf("_");if(e<0){continue}var g=c.substring(0,e+1)+"Deleted";var l=document.getElementById(g);if(l!=null&&l.value=="True"){continue}var f=c.lastIndexOf("___");var d=c.substring(0,f);var b=d.lastIndexOf("_")+1;d=d.substring(b);if(i>0){h=h+","}h=h+d}k.value=h}var ManipulationButtonRemove="ManipulationButtonRemove";var ManipulationButtonHide="ManipulationButtonHide";var ManipulationButtonShow="ManipulationButtonShow";var ManipulationButtonResetGrid="ManipulationButtonResetGrid";var ManipulationButtonCustom="ManipulationButtonCustom";function ManipulationButton_Click(target,dataButtonType){var end_prefix=target.lastIndexOf("_");var deleteName=target.substring(0,end_prefix);end_prefix=deleteName.lastIndexOf("_");deleteName=deleteName.substring(0,end_prefix+1)+"Deleted";var deletedHidden=document.getElementById(deleteName);if(dataButtonType==ManipulationButtonRemove){$("#"+target).remove();Update_Permutations(target)}else{if(dataButtonType==ManipulationButtonHide){$("#"+target).css("visibility","hidden");if(deletedHidden!=null){deletedHidden.value="True"}Update_Permutations(target)}else{if(dataButtonType==ManipulationButtonShow){$("#"+target).css("visibility","visible");if(deletedHidden!=null){deletedHidden.value="False"}Update_Permutations(target)}else{if(dataButtonType==ManipulationButtonResetGrid){var toUndo=eval(target+AllNormalPostfix);if(toUndo!=null){for(var i=0;i<toUndo.length;i++){var vChanged=toUndo[i].substring(0,toUndo[i].lastIndexOf("_"))+ChandedPostfix;var deleted=eval(toUndo[i]+DeletedPostFix);if(deleted!=null&&deleted==true){DataButton_Click(toUndo[i],vChanged,DataButtonUndelete)}else{DataButton_Click(toUndo[i],vChanged,DataButtonCancel)}}}}else{eval(target)}}}}}function PageButton_Click(d,c,e,b,a){if(e==""){if(!MvcControlsToolkit_FormIsValid(d,a)){return}var f=document.getElementById(d);f.value=c;$("#"+d).parents("form").submit()}else{if(b!=""){$.ajax({type:"GET",url:e,success:function(g){$("#"+b).html(g)}})}else{window.location.href=e}}}function Sort_Handler(field,buttonName,initialize,causePostback,clientOrderChanged,sortField,pageField,cssNoSort,cssAscending,cssDescending,validationType){if(!initialize&&causePostback&&!MvcControlsToolkit_FormIsValid(sortField,validationType)){return}var order=$("#"+sortField).val();var hasAscending=order.indexOf(" "+field+"#+;");var hasDescending=order.indexOf(" "+field+"#-;");var prevOrder="";var actualOrder="";if(!initialize){if(hasDescending>=0){order=order.replace(" "+field+"#-;","");$("#"+sortField).val(order);$("#"+buttonName).removeClass(cssDescending);$("#"+buttonName).addClass(cssNoSort);prevOrder="-"}else{if(hasAscending>=0){order=order.replace(" "+field+"#+;"," "+field+"#-;");$("#"+sortField).val(order);$("#"+buttonName).removeClass(cssAscending);$("#"+buttonName).addClass(cssDescending);prevOrder="+";actualOrder="-"}else{order=order+" "+field+"#+;";$("#"+sortField).val(order);$("#"+buttonName).removeClass(cssNoSort);$("#"+buttonName).addClass(cssAscending);actualOrder="+"}}if(pageField!=null){$("#"+pageField).val("1")}if(clientOrderChanged!=null){eval(clientOrderChanged+"('"+field+"', '"+prevOrder+"', '"+actualOrder+"')")}if(causePostback){$("#"+sortField).parents("form").submit()}}else{if(hasDescending>=0){$("#"+buttonName).addClass(cssDescending)}else{if(hasAscending>=0){$("#"+buttonName).addClass(cssAscending)}else{$("#"+buttonName).addClass(cssNoSort)}}}}function Setup_Ajax_ClientValidation(d,a){if(a==ValidationType_StandardClient){var e=window.mvcClientValidationMetadata;if(e){for(var b=0;b<e.length;b++){var c=e[b];c.FormId=d}}Sys.Mvc.FormContext._Application_Load()}else{if(typeof $!=="undefined"&&$!==null&&typeof $.validator!=="undefined"&&$.validator!==null&&typeof $.validator.unobtrusive!=="undefined"&&$.validator.unobtrusive!==null){$.validator.unobtrusive.clearAndParse("#"+d)}}}function OnBeginDetailForm(baseName,detailType,rowId,loadingElementId,validationType){detailBusy=eval(baseName+"_DetailBusy");if(detailBusy){return false}eval(baseName+"_DetailBusy = true;");eval(baseName+"_TypeDetail = '"+detailType+"';");if(rowId!=null){if(detailType=="Insert"){eval(baseName+"_CurrentRow = null;")}else{eval(baseName+"_CurrentRow = '"+rowId+"';")}}else{var res=MvcControlsToolkit_FormIsValid(loadingElementId,validationType);return res}return true}function OnFailureDetailForm(baseName,displayExecute,editExecute){var detailType=eval(baseName+"_TypeDetail");if(detailType=="Display"){if(displayExecute!=null){(displayExecute+"();")}}else{if(editExecute!=null){(editExecute+"();")}}eval(baseName+"_DetailBusy = false;")}function TrueValue(value,fieldName){var trueValue=value;try{trueValue=eval(fieldName+"_True")}catch(e){}return trueValue}function FormattedValue(value,fieldName){var fValue=value;try{fValue=eval(fieldName+"_Format")}catch(e){}var companionField=document.getElementById(fieldName+"_hidden");if(companionField!=null){fValue=companionField.value}return fValue}function OnSuccessDetailForm(baseName,displayExecute,editExecute,ajaxContext,formId,validationType,unobtrusiveAjaxOn){if(!unobtrusiveAjaxOn){GlobalEvalScriptInElementId(ajaxContext.get_updateTarget())}if(validationType!=ValidationType_Server){Setup_Ajax_ClientValidation(formId,validationType)}var detailType=eval(baseName+"_TypeDetail");var changedFieldCss=eval(baseName+"_ChangedFieldCss");var deletedRecordCss=eval(baseName+"_DeletedRecordCss");var isValid=false;var hiddenIsValid=document.getElementById("IsValid");if(hiddenIsValid!=null&&hiddenIsValid.value=="True"){isValid=true}if(isValid&&(detailType=="FirstEdit"||detailType=="Edit"||detailType=="Display")){var itemRoot=eval(baseName+"_CurrentRow");var fieldsToUpdate=eval(baseName+"_FieldsToUpdate").split(",");var detailRoot=eval(baseName+"_DetailPrefix");if(itemRoot!=null){var oldItemRoot=itemRoot.substring(0,itemRoot.lastIndexOf("Value"))+"OldValue";var isInsert=true;var isExternalDelete=true;var changedDisplay=eval(itemRoot+SavePostFixC);var changedDisplayAvailable=false;if(changedDisplay==null){changedDisplay=eval(itemRoot+SavePostFixD)}else{changedDisplayAvailable=true}for(var i=0;i<fieldsToUpdate.length;i++){var oldField=document.getElementById(oldItemRoot+"_"+fieldsToUpdate[i]);if(oldField!=null){isInsert=false}var newFieldName=null;if(detailRoot.length==0){newFieldName=fieldsToUpdate[i]}else{newFieldName=oldItemRoot+"_"+fieldsToUpdate[i]}var newField=document.getElementById(newFieldName);if(newField!=null){isExternalDelete=false}if(oldField!=null){var newValue=null;var newFormattedValue=null;if(newField!=null&&newField.getAttribute("type")!=null&&newField.getAttribute("type").toLowerCase()=="checkbox"){if(newField.getAttribute("checked")!=null&&newField.checked==true){newValue="True"}else{newValue="False"}}else{if(newField!=null){if(newField.nodeName!=null&&(newField.nodeName.toLowerCase()=="input"||newField.nodeName.toLowerCase()=="textarea")){newValue=TrueValue(newField.value,newFieldName);newFormattedValue=FormattedValue(newField.value,newFieldName)}else{newValue=TrueValue(newField.childNodes(0).nodeValue,newFieldName);newFormattedValue=FormattedValue(newField.childNodes(0).nodeValue,newFieldName)}}else{newValue=TrueValue(null,newFieldName);newFormattedValue=FormattedValue(null,newFieldName)}}var itemToUpdate=changedDisplay.find("#"+itemRoot+"_"+fieldsToUpdate[i]);if(changedFieldCss!=null){if(newValue!=null&&oldField.value!=newValue){itemToUpdate.addClass(changedFieldCss)}else{itemToUpdate.removeClass(changedFieldCss)}}if(newValue!=null&&oldField.value!=newValue){oldField.value=newValue;if(itemToUpdate.length!=0){var inputType=itemToUpdate.attr("type");if(inputType!=null&&inputType.toLowerCase()=="checkbox"){if(newValue.toLowerCase()=="true"){itemToUpdate.checked=true}else{itemToUpdate.checked=false}}else{itemToUpdate.html(newFormattedValue)}}}}}if(isExternalDelete){$('input[id^="'+oldItemRoot+'"]').remove();if(deletedRecordCss!=null){var newSavePostFixD=eval(itemRoot+SavePostFixD);newSavePostFixD.addClass(deletedRecordCss);$("#"+itemRoot+DisplayPostfix+ContainerPostFix).replaceWith(newSavePostFixD.clone(true))}}else{if(!isInsert){if(changedDisplayAvailable){eval(itemRoot+SavePostFixD+" = "+itemRoot+SavePostFixC+";")}var newSavePostFixD=eval(itemRoot+SavePostFixD);$("#"+itemRoot+DisplayPostfix+ContainerPostFix).replaceWith(newSavePostFixD.clone(true))}}}}if(detailType=="Display"){if(displayExecute!=null){eval(displayExecute+"();")}}else{if(editExecute!=null){eval(editExecute+"();")}}eval(baseName+"_DetailBusy = false;")}function ViewList_Client(groupName,hiddenField,cssSelected,prefix){this.CssSelected=cssSelected;this.GroupName=groupName;this.HiddenField=hiddenField;this.Prefix=prefix;$("."+groupName).each(function(i){var name=this.id+"_placeholder";var thisId=this.id;$("#"+this.id).before("<span style='display:none;' id='"+name+"'></span>");$("."+this.id+"_checkbox").click(function(){eval(groupName+"_ViewList").Select(thisId)})});this.SelectionSet=$("."+groupName).detach()}ViewList_Client.prototype={HiddenField:null,GroupName:null,CssSelected:null,SelectionSet:null,Prefix:null,Select:function(a){$("."+this.GroupName+"_button").removeClass(this.CssSelected);$("."+this.GroupName+"_checkbox").attr("checked",false);$("."+this.GroupName).detach();if(a==""){document.getElementById(this.HiddenField).value="";return}document.getElementById(this.HiddenField).value=a;a=this.Prefix+a;this.SelectionSet.filter("#"+a).insertBefore("#"+a+"_placeholder");$("."+a+"_button").addClass(this.CssSelected);$("."+a+"_checkbox").attr("checked",true)}};var MvcControlsToolkit_DataType_String=0;var MvcControlsToolkit_DataType_UInt=1;var MvcControlsToolkit_DataType_Int=2;var MvcControlsToolkit_DataType_Float=3;function MvcControlsToolkit_ToString(b,c,a){if(a==MvcControlsToolkit_DataType_String){return b}if(c==""){c="n"}if((typeof jQuery!=="undefined")&&(typeof jQuery.global!=="undefined")&&(typeof jQuery.global.parseInt==="function")){return jQuery.global.format(b,c)}else{if((typeof Number!=="undefined")&&(typeof Number.parseLocale==="function")){return b.localeFormat(c)}else{return b+""}}}function MvcControlsToolkit_Parse(c,b){if(b==MvcControlsToolkit_DataType_String){return c}if(b==MvcControlsToolkit_DataType_Float){if((typeof jQuery!=="undefined")&&(typeof jQuery.global!=="undefined")&&(typeof jQuery.global.parseFloat=="function")){return jQuery.global.parseFloat(c)}else{if((typeof Number!=="undefined")&&(typeof Number.parseLocale=="function")){return Number.parseLocale(c)}else{return parseFloat(c)}}}else{if((typeof jQuery!=="undefined")&&(typeof jQuery.global!=="undefined")&&(typeof jQuery.parseInt=="function")){return jQuery.global.parseInt(c)}else{if(typeof Number.parseLocale=="function"){var a=Number.parseLocale(c);if(isNaN(a)){return a}return parseInt(a+"")}else{return parseInt(c,10)}}}}function MvcControlsToolkit_TypedTextBox_Input(j,d,a,f,h,e,c,b){if(f==MvcControlsToolkit_DataType_String||j==0||j==13||j==8||j==e.charCodeAt(0)||(j>=48&&j<=57)){return true}if((f==MvcControlsToolkit_DataType_Int||f==MvcControlsToolkit_DataType_Float)&&(j==c.charCodeAt(0)||j==b.charCodeAt(0))){var g=document.getElementById(d).value;return g.indexOf(c)<0&&g.indexOf(b)<0}if(f==MvcControlsToolkit_DataType_Float&&j==h.charCodeAt(0)){var g=document.getElementById(d).value;return g.indexOf(h)<0}return false}function MvcControlsToolkit_TypedTextBox_Focus(a,c,b){document.getElementById(a).value=document.getElementById(c).value;if(b!=""){$("#"+a).removeClass(b)}}function MvcControlsToolkit_TypedTextBox_Blur(q,x,p,m,s,t,u,b,d,l,h,j,g){var a=document.getElementById(q);if(a==null){return}var n=a.value;if($("#"+q).hasClass(j)){n=""}var o=n;if(p!=MvcControlsToolkit_DataType_String){n=MvcControlsToolkit_Trim(n);o=n;var f=n;f=f.replace(l,"");tvalue=f.replace(u,"");negative=f.indexOf(b);f=f.replace(b,"");var w="";var c="";for(var r=0;r<f.length;r++){c=f.charCodeAt(r);if((c>=48&&c<=57)||c==d.charCodeAt(0)){w=w+f.charAt(r)}}f=w;if(n!=""){var k=0;try{k=MvcControlsToolkit_Parse(f,p);if(negative>=0){k=k*-1}if(!isNaN(k)){n=MvcControlsToolkit_ToString(k,t,p);if(p==MvcControlsToolkit_DataType_Float){if(negative>=0){o=b+f}else{o=f}}else{o=MvcControlsToolkit_ToString(k,"n0",p)}}}catch(v){}}}document.getElementById(x).value=o;MvcControlsToolkit_Validate(x,g);if(n==""){if(j!=""){$("#"+q).addClass(j)}document.getElementById(q).value=h}else{document.getElementById(q).value=m+n+s}};